{"version":3,"file":"index.js","sources":["../src/lib/Util.ts","../src/lib/Filter.ts","../src/lib/Canvas.ts"],"sourcesContent":["import { Canvas as NodeCanvas, Image, loadImage } from 'canvas';\nimport type { Canvas, LoadableImage } from './Canvas';\n\nexport const browser = typeof window !== 'undefined';\n\nexport const internalCanvas = (() => {\n\t// eslint-disable-next-line no-undef\n\treturn browser ? (typeof HTMLCanvasElement === 'undefined' ? null : HTMLCanvasElement) : require('canvas');\n})();\n\nexport const getFontHeight = (() => {\n\t// node-canvas has its own font parser\n\tif (!browser && 'parseFont' in internalCanvas) return (font: string): number => internalCanvas.parseFont(font).size;\n\n\t// Load polyfill\n\tconst kRegexSize = /([\\d.]+)(px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q)/i;\n\tconst kCache = new Map<string, number>();\n\n\treturn (font: string): number => {\n\t\t// If it was already parsed, do not parse again\n\t\tconst previous = kCache.get(font);\n\t\tif (previous) return previous;\n\n\t\t// Test for required properties first, return null if the text is invalid\n\t\tconst sizeFamily = kRegexSize.exec(font);\n\t\tif (!sizeFamily) return 0;\n\n\t\tlet size = Number(sizeFamily[1]);\n\t\tconst unit = sizeFamily[2];\n\n\t\tswitch (unit) {\n\t\t\tcase 'pt':\n\t\t\t\tsize /= 0.75;\n\t\t\t\tbreak;\n\t\t\tcase 'pc':\n\t\t\t\tsize *= 16;\n\t\t\t\tbreak;\n\t\t\tcase 'in':\n\t\t\t\tsize *= 96;\n\t\t\t\tbreak;\n\t\t\tcase 'cm':\n\t\t\t\tsize *= 96.0 / 2.54;\n\t\t\t\tbreak;\n\t\t\tcase 'mm':\n\t\t\t\tsize *= 96.0 / 25.4;\n\t\t\t\tbreak;\n\t\t\tcase 'em':\n\t\t\tcase 'rem':\n\t\t\t\tsize *= 16 / 0.75;\n\t\t\t\tbreak;\n\t\t\tcase 'q':\n\t\t\t\tsize *= 96 / 25.4 / 4;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tkCache.set(font, size);\n\t\treturn size;\n\t};\n})();\n\nexport const textWrap = (canvas: Canvas, text: string, wrapWidth: number): string => {\n\tconst result = [];\n\tconst buffer = [];\n\n\tconst spaceWidth = canvas.measureText(' ').width;\n\n\t// Run the loop for each line\n\tfor (const line of text.split(/\\r?\\n/)) {\n\t\tlet spaceLeft = wrapWidth;\n\n\t\t// Run the loop for each word\n\t\tfor (const word of line.split(' ')) {\n\t\t\tconst wordWidth = canvas.measureText(word).width;\n\t\t\t// eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n\t\t\tconst wordWidthWithSpace = wordWidth + spaceWidth;\n\n\t\t\tif (wordWidthWithSpace > spaceLeft) {\n\t\t\t\tif (buffer.length) {\n\t\t\t\t\tresult.push(buffer.join(' '));\n\t\t\t\t\tbuffer.length = 0;\n\t\t\t\t}\n\t\t\t\tbuffer.push(word);\n\t\t\t\tspaceLeft = wrapWidth - wordWidth;\n\t\t\t} else {\n\t\t\t\tspaceLeft -= wordWidthWithSpace;\n\t\t\t\tbuffer.push(word);\n\t\t\t}\n\t\t}\n\n\t\tif (buffer.length) {\n\t\t\tresult.push(buffer.join(' '));\n\t\t\tbuffer.length = 0;\n\t\t}\n\t}\n\n\treturn result.join('\\n');\n};\n\n/**\n * Resolves an Image or Buffer\n * @param src An Image instance or a buffer\n * @param cb The callback\n */\nexport const resolveImage = (src: LoadableImage, options?: any): Promise<NodeCanvas | Image> => {\n\tif (browser) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// eslint-disable-next-line no-undef\n\t\t\tconst image = Object.assign(document.createElement('img'), options);\n\n\t\t\tfunction cleanup() {\n\t\t\t\timage.onload = null;\n\t\t\t\timage.onerror = null;\n\t\t\t}\n\n\t\t\timage.onload = () => {\n\t\t\t\tcleanup();\n\t\t\t\tresolve(image);\n\t\t\t};\n\t\t\timage.onerror = () => {\n\t\t\t\tcleanup();\n\t\t\t\treject(new Error(`Failed to load the image \"${src}\"`));\n\t\t\t};\n\n\t\t\timage.src = src;\n\t\t});\n\t}\n\n\treturn loadImage(src, options);\n};\n\n/**\n * Utility to format an hexadecimal string into a CSS hexadecimal string.\n * @param hex The hexadecimal code.\n * @example\n * hex('FFF'); // -> '#FFF'\n * hex('0F0F0F'); // -> '#0F0F0F'\n */\nexport const hex = (hex: string): string => `#${hex}`;\n\n/**\n * Utility to format a RGB set of values into a string.\n * @param red The red value, must be a number between 0 and 255 inclusive.\n * @param green The green value, must be a number between 0 and 255 inclusive.\n * @param blue The blue value, must be a number between 0 and 255 inclusive.\n * @see https://en.wikipedia.org/wiki/RGB_color_model#Geometric_representation\n * @example\n * rgb(255, 150, 65); // -> 'rgb(255, 150, 65)'\n */\nexport const rgb = (red: number, green: number, blue: number): string => `rgb(${red}, ${green}, ${blue})`;\n\n/**\n * Utility to format a RGBA set of values into a string.\n * @param red The red value, must be a number between 0 and 255 inclusive.\n * @param green The green value, must be a number between 0 and 255 inclusive.\n * @param blue The blue value, must be a number between 0 and 255 inclusive.\n * @param alpha The alpha value, must be a number between 0 and 1 inclusive.\n * @see https://en.wikipedia.org/wiki/RGB_color_model#Geometric_representation\n * @example\n * rgba(255, 150, 65, 0.3); // -> 'rgba(255, 150, 65, 0.3)'\n */\nexport const rgba = (red: number, green: number, blue: number, alpha: number): string => `rgba(${red}, ${green}, ${blue}, ${alpha})`;\n\n/**\n * Utility to format a HSL set of values into a string.\n * @param hue The hue, must be a number between 0 and 360 inclusive.\n * @param saturation The saturation, must be a number between 0 and 100 inclusive.\n * @param lightness The lightness, must be a number between 0 and 100 inclusive, 0 will make it black, 100 will make it white.\n * @see https://en.wikipedia.org/wiki/HSL_and_HSV\n * @example\n * hsl(120, 100, 40); // -> 'hsl(120, 100, 40)'\n */\nexport const hsl = (hue: number, saturation: number, lightness: number): string => `hsl(${hue}, ${saturation}%, ${lightness}%)`;\n\n/**\n * Utility to format a HSLA set of values into a string.\n * @param hue The hue, must be a number between 0 and 360 inclusive.\n * @param saturation The saturation, must be a number between 0 and 100 inclusive.\n * @param lightness The lightness, must be a number between 0 and 100 inclusive, 0 will make it black, 100 will make it white\n * @param alpha The alpha value, must be a number between 0 and 1 inclusive.\n * @see https://en.wikipedia.org/wiki/HSL_and_HSV\n * @example\n * hsla(120, 100, 40, 0.4); // -> 'hsla(120, 100, 40, 0.4)'\n */\nexport const hsla = (hue: number, saturation: number, lightness: number, alpha: number): string =>\n\t`hsla(${hue}, ${saturation}%, ${lightness}%, ${alpha})`;\n\n/**\n * Utility to type-safely use CSS colors.\n * @param color The CSS keyword color.\n * @example\n * color('silver'); // ✔\n * color('some-imaginary-number'); // ❌\n */\nexport const color = (color: ColorKeyword): ColorKeyword => color;\n\nexport type ColorKeyword = ColorKeywordLevel1 | ColorKeywordLevel2 | ColorKeywordLevel3 | ColorKeywordLevel4;\n\nexport type ColorKeywordLevel1 =\n\t| 'black'\n\t| 'silver'\n\t| 'gray'\n\t| 'white'\n\t| 'maroon'\n\t| 'red'\n\t| 'purple'\n\t| 'fuchsia'\n\t| 'green'\n\t| 'lime'\n\t| 'olive'\n\t| 'yellow'\n\t| 'navy'\n\t| 'blue'\n\t| 'teal'\n\t| 'aqua';\n\nexport type ColorKeywordLevel2 = 'orange';\n\nexport type ColorKeywordLevel3 =\n\t| 'aliceblue'\n\t| 'antiquewhite'\n\t| 'aquamarine'\n\t| 'azure'\n\t| 'beige'\n\t| 'bisque'\n\t| 'blanchedalmond'\n\t| 'blueviolet'\n\t| 'brown'\n\t| 'burlywood'\n\t| 'cadetblue'\n\t| 'chartreuse'\n\t| 'chocolate'\n\t| 'coral'\n\t| 'cornflowerblue'\n\t| 'cornsilk'\n\t| 'crimson'\n\t| 'cyan'\n\t| 'darkblue'\n\t| 'darkcyan'\n\t| 'darkgoldenrod'\n\t| 'darkgray'\n\t| 'darkgreen'\n\t| 'darkgrey'\n\t| 'darkkhaki'\n\t| 'darkmagenta'\n\t| 'darkolivegreen'\n\t| 'darkorange'\n\t| 'darkorchid'\n\t| 'darkred'\n\t| 'darksalmon'\n\t| 'darkseagreen'\n\t| 'darkslateblue'\n\t| 'darkslategray'\n\t| 'darkslategrey'\n\t| 'darkturquoise'\n\t| 'darkviolet'\n\t| 'deeppink'\n\t| 'deepskyblue'\n\t| 'dimgray'\n\t| 'dimgrey'\n\t| 'dodgerblue'\n\t| 'firebrick'\n\t| 'floralwhite'\n\t| 'forestgreen'\n\t| 'gainsboro'\n\t| 'ghostwhite'\n\t| 'gold'\n\t| 'goldenrod'\n\t| 'greenyellow'\n\t| 'grey'\n\t| 'honeydew'\n\t| 'hotpink'\n\t| 'indianred'\n\t| 'indigo'\n\t| 'ivory'\n\t| 'khaki'\n\t| 'lavender'\n\t| 'lavenderblush'\n\t| 'lawngreen'\n\t| 'lemonchiffon'\n\t| 'lightblue'\n\t| 'lightcoral'\n\t| 'lightcyan'\n\t| 'lightgoldenrodyellow'\n\t| 'lightgray'\n\t| 'lightgreen'\n\t| 'lightgrey'\n\t| 'lightpink'\n\t| 'lightsalmon'\n\t| 'lightseagreen'\n\t| 'lightskyblue'\n\t| 'lightslategray'\n\t| 'lightslategrey'\n\t| 'lightsteelblue'\n\t| 'lightyellow'\n\t| 'limegreen'\n\t| 'linen'\n\t| 'magenta'\n\t| 'mediumaquamarine'\n\t| 'mediumblue'\n\t| 'mediumorchid'\n\t| 'mediumpurple'\n\t| 'mediumseagreen'\n\t| 'mediumslateblue'\n\t| 'mediumspringgreen'\n\t| 'mediumturquoise'\n\t| 'mediumvioletred'\n\t| 'midnightblue'\n\t| 'mintcream'\n\t| 'mistyrose'\n\t| 'moccasin'\n\t| 'navajowhite'\n\t| 'oldlace'\n\t| 'olivedrab'\n\t| 'orangered'\n\t| 'orchid'\n\t| 'palegoldenrod'\n\t| 'palegreen'\n\t| 'paleturquoise'\n\t| 'palevioletred'\n\t| 'papayawhip'\n\t| 'peachpuff'\n\t| 'peru'\n\t| 'pink'\n\t| 'plum'\n\t| 'powderblue'\n\t| 'rosybrown'\n\t| 'royalblue'\n\t| 'saddlebrown'\n\t| 'salmon'\n\t| 'sandybrown'\n\t| 'seagreen'\n\t| 'seashell'\n\t| 'sienna'\n\t| 'skyblue'\n\t| 'slateblue'\n\t| 'slategray'\n\t| 'slategrey'\n\t| 'snow'\n\t| 'springgreen'\n\t| 'steelblue'\n\t| 'tan'\n\t| 'thistle'\n\t| 'tomato'\n\t| 'turquoise'\n\t| 'violet'\n\t| 'wheat'\n\t| 'whitesmoke'\n\t| 'yellowgreen';\n\nexport type ColorKeywordLevel4 = 'rebeccapurple';\n","import type { Canvas } from './Canvas';\n\n/**\n * Invert an image\n * @param canvas The Canvas instance\n */\nexport const invert = (canvas: Canvas) =>\n\tcanvas.save().setGlobalCompositeOperation('difference').setColor('white').printRectangle(0, 0, canvas.width, canvas.height).restore();\n\n/**\n * Greyscale an image\n * @param canvas The Canvas instance\n */\nexport const greyscale = (canvas: Canvas) => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tconst luminance = 0.2126 * data[i] + 0.7152 * data[i + 1] + 0.0722 * data[i + 2];\n\t\tdata[i] = luminance;\n\t\tdata[i + 1] = luminance;\n\t\tdata[i + 2] = luminance;\n\t}\n\n\treturn canvas.putImageData(imageData, 0, 0);\n};\nexport const grayscale = greyscale;\n\n/**\n * Invert then greyscale an image\n * @param canvas The Canvas instance\n */\nexport const invertGrayscale = (canvas: Canvas): Canvas => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tconst luminance = 255 - (0.2126 * data[i] + 0.7152 * data[i + 1] + 0.0722 * data[i + 2]);\n\t\tdata[i] = luminance;\n\t\tdata[i + 1] = luminance;\n\t\tdata[i + 2] = luminance;\n\t}\n\n\treturn canvas.putImageData(imageData, 0, 0);\n};\nexport const invertGreyscale = invertGrayscale;\n\n/**\n * Give an image a sepia tone\n * @param canvas The Canvas instance\n */\nexport const sepia = (canvas: Canvas): Canvas => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tconst r = data[i];\n\t\tconst g = data[i + 1];\n\t\tconst b = data[i + 2];\n\t\tdata[i] = r * 0.393 + g * 0.769 + b * 0.189;\n\t\tdata[i + 1] = r * 0.349 + g * 0.686 + b * 0.168;\n\t\tdata[i + 2] = r * 0.272 + g * 0.534 + b * 0.131;\n\t}\n\treturn canvas.putImageData(imageData, 0, 0);\n};\n\n/**\n * Turn an image into a silhouette\n * @param canvas The Canvas instance\n */\nexport const silhouette = (canvas: Canvas): Canvas => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tdata[i] = 0;\n\t\tdata[i + 1] = 0;\n\t\tdata[i + 2] = 0;\n\t}\n\n\treturn canvas.putImageData(imageData, 0, 0);\n};\n\n/**\n * Apply a threshold to the image\n * @param canvas The Canvas instance\n * @param threshold The threshold to apply in a range of 0 to 255\n */\nexport const threshold = (canvas: Canvas, threshold: number): Canvas => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tconst luminance = 0.2126 * data[i] + 0.7152 * data[i + 1] + 0.0722 * data[i + 2] >= threshold ? 255 : 0;\n\t\tdata[i] = luminance;\n\t\tdata[i + 1] = luminance;\n\t\tdata[i + 2] = luminance;\n\t}\n\n\treturn canvas.putImageData(imageData, 0, 0);\n};\n\n/**\n * Apply an inverted threshold to the image\n * @param canvas The Canvas instance\n * @param threshold The threshold to apply in a range of 0 to 255\n */\nexport const invertedThreshold = (canvas: Canvas, threshold: number): Canvas => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tconst luminance = 0.2126 * data[i] + 0.7152 * data[i + 1] + 0.0722 * data[i + 2] >= threshold ? 0 : 255;\n\t\tdata[i] = luminance;\n\t\tdata[i + 1] = luminance;\n\t\tdata[i + 2] = luminance;\n\t}\n\n\treturn canvas.putImageData(imageData, 0, 0);\n};\n\n/**\n * Brighten an image\n * @param canvas The Canvas instance\n * @param brightness The brightness to apply in a range of 0 to 255\n */\nexport const brightness = (canvas: Canvas, brightness: number): Canvas => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tdata[i] += brightness;\n\t\tdata[i + 1] += brightness;\n\t\tdata[i + 2] += brightness;\n\t}\n\n\treturn canvas.putImageData(imageData, 0, 0);\n};\n\n/**\n * Darken an image\n * @param canvas The Canvas instance\n * @param darkness The darkness to apply in a range of 0 to 255\n */\nexport const darkness = (canvas: Canvas, darkness: number): Canvas => {\n\tconst imageData = canvas.getImageData();\n\tconst { data } = imageData;\n\tfor (let i = 0; i < data.length; i += 4) {\n\t\tdata[i] -= darkness;\n\t\tdata[i + 1] -= darkness;\n\t\tdata[i + 2] -= darkness;\n\t}\n\n\treturn canvas.putImageData(imageData, 0, 0);\n};\nexport const myOldFriend = darkness;\n\n/**\n * Convolute a image. This filter needs a fix.\n * @param canvas The Canvas instance\n * @param weights The weights\n * @param opaque Whether or not pixels should try to be opaque\n * @see https://www.html5rocks.com/en/tutorials/canvas/imagefilters/\n */\nexport const convolute = (canvas: Canvas, weights: readonly number[], opaque = true): Canvas => {\n\tconst side = Math.round(Math.sqrt(weights.length));\n\tconst halfSide = Math.floor(side / 2);\n\n\tconst pixels = canvas.getImageData();\n\tconst src = pixels.data;\n\tconst sw = pixels.width;\n\tconst sh = pixels.height;\n\n\t// pad output by the convolution matrix\n\tconst w = sw;\n\tconst h = sh;\n\tconst output = canvas.getImageData();\n\tconst dst = output.data;\n\n\t// go through the destination image pixels\n\tconst alphaFac = opaque ? 1 : 0;\n\tfor (let y = 0; y < h; y++) {\n\t\tfor (let x = 0; x < w; x++) {\n\t\t\tconst sy = y;\n\t\t\tconst sx = x;\n\t\t\tconst dstOff = (y * w + x) * 4;\n\t\t\t// calculate the weighed sum of the source image pixels that\n\t\t\t// fall under the convolution matrix\n\t\t\tlet r = 0;\n\t\t\tlet g = 0;\n\t\t\tlet b = 0;\n\t\t\tlet a = 0;\n\t\t\tfor (let cy = 0; cy < side; cy++) {\n\t\t\t\tfor (let cx = 0; cx < side; cx++) {\n\t\t\t\t\tconst scy = sy + cy - halfSide;\n\t\t\t\t\tconst scx = sx + cx - halfSide;\n\t\t\t\t\tif (scy >= 0 && scy < sh && scx >= 0 && scx < sw) {\n\t\t\t\t\t\tconst srcOff = (scy * sw + scx) * 4;\n\t\t\t\t\t\tconst wt = weights[cy * side + cx];\n\t\t\t\t\t\tr += src[srcOff] * wt;\n\t\t\t\t\t\tg += src[srcOff + 1] * wt;\n\t\t\t\t\t\tb += src[srcOff + 2] * wt;\n\t\t\t\t\t\ta += src[srcOff + 3] * wt;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdst[dstOff] = r;\n\t\t\tdst[dstOff + 1] = g;\n\t\t\tdst[dstOff + 2] = b;\n\t\t\tdst[dstOff + 3] = a + alphaFac * (255 - a);\n\t\t}\n\t}\n\n\treturn canvas.putImageData(output, 0, 0);\n};\n\n/**\n * The LaPlace matrix for edge\n * @internal\n */\nconst edgeLaPlaceMatrix = [0, -1, 0, -1, 4, -1, 0, -1, 0];\n\n/**\n * Display an image's edges\n * @param canvas The Canvas instance\n */\nexport const edge = (canvas: Canvas): Canvas => convolute(canvas, edgeLaPlaceMatrix, true);\n\n/**\n * The LaPlace matrix for sharpen\n * @internal\n */\nconst sharpenLaPlaceMatrix = [0, -1, 0, -1, 5, -1, 0, -1, 0];\n\n/**\n * Sharpen an image\n * @param canvas The Canvas instance\n * @param passes The amount of iterations to do\n */\nexport const sharpen = (canvas: Canvas, passes = 1): Canvas => {\n\tfor (let i = 0; i < passes; ++i) {\n\t\tconvolute(canvas, sharpenLaPlaceMatrix, true);\n\t}\n\n\treturn canvas;\n};\n\n/**\n * The LaPlace matrix for blur\n * @internal\n */\nconst blurLaPlaceMatrix = [1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9, 1 / 9];\n\n/**\n * Blur an image\n * @param canvas The Canvas instance\n * @param passes The amount of iterations to do\n */\nexport const blur = (canvas: Canvas, passes = 1): Canvas => {\n\tfor (let i = 0; i < passes; ++i) {\n\t\tconvolute(canvas, blurLaPlaceMatrix, true);\n\t}\n\n\treturn canvas;\n};\n","/* eslint-disable @typescript-eslint/unified-signatures */\nimport { Canvas as NodeCanvas, CanvasRenderingContext2D, createCanvas, Image, JpegConfig, PdfConfig, PngConfig } from 'canvas';\nimport { getFontHeight, textWrap } from './Util';\n\nexport interface ImageDataCallback {\n\t(this: Canvas, data: ImageData, canvas: Canvas): unknown;\n}\n\nexport interface MeasureTextCallback {\n\t(this: Canvas, measurement: TextMetrics, canvas: Canvas): unknown;\n}\n\nexport interface WrapTextCallback {\n\t(this: Canvas, text: string, canvas: Canvas): unknown;\n}\n\nexport interface PatternCallback {\n\t(this: Canvas, pattern: CanvasPattern, canvas: Canvas): unknown;\n}\n\nexport interface BeveledRadiusOptions {\n\t/**\n\t * Top left corner.\n\t */\n\ttl: number;\n\n\t/**\n\t * Top right corner.\n\t */\n\ttr: number;\n\n\t/**\n\t * Bottom right corner.\n\t */\n\tbr: number;\n\n\t/**\n\t * Bottom left corner.\n\t */\n\tbl: number;\n}\n\nexport interface GradientStop {\n\tposition: number;\n\tcolor: string;\n}\n\nexport type GlobalCompositeOperation = CanvasRenderingContext2D['globalCompositeOperation'];\nexport type AntiAlias = CanvasRenderingContext2D['antialias'];\nexport type TextDrawingMode = CanvasRenderingContext2D['textDrawingMode'];\nexport type PatternQuality = CanvasRenderingContext2D['patternQuality'];\nexport type PatternRepeat = 'repeat' | 'repeat-x' | 'repeat-y' | 'no-repeat' | '' | null;\nexport type LoadableImage = string | Buffer;\nexport type ImageResolvable = Canvas | Image;\n\nexport class Canvas {\n\t/**\n\t * The constructed Canvas\n\t * @since 0.0.1\n\t */\n\tprivate canvas: NodeCanvas | HTMLCanvasElement;\n\n\t/**\n\t * The 2D context for the Canvas.\n\t * @since 0.0.1\n\t */\n\tprivate context: CanvasRenderingContext2D | CanvasRenderingContext2D;\n\n\t/**\n\t * Initialize canvas-constructor in a browser.\n\t * @param canvas An HTMLCanvasElement.\n\t * <script type=\"text/javascript\" src=\"canvasconstructor.master.min.js\"></script>\n\t * <script type=\"text/javascript\">\n\t * const canvasElement = document.getElementById('canvas');\n\t * new CanvasConstructor.Canvas(canvasElement)\n\t *     .setColor('green')\n\t *     .printRectangle(10, 10, 100, 100);\n\t * </script>\n\t */\n\tpublic constructor(canvas: HTMLCanvasElement);\n\t/**\n\t * Initialize canvas-constructor\n\t * @param width The canvas' width in pixels.\n\t * @param height The canvas' height in pixels.\n\t * @param type The canvas type.\n\t */\n\tpublic constructor(width: number, height: number, type?: 'pdf' | 'svg');\n\tpublic constructor(width: number | HTMLCanvasElement, height?: number, type?: 'pdf' | 'svg') {\n\t\tthis.canvas = typeof width === 'number' ? createCanvas(width, height!, type) : width;\n\t\tthis.context = this.canvas.getContext('2d') as CanvasRenderingContext2D;\n\t}\n\n\tprivate get windowCanvas(): HTMLCanvasElement {\n\t\treturn (this.canvas as unknown) as HTMLCanvasElement;\n\t}\n\n\t/**\n\t * The image width of this canvas\n\t * @since 0.0.1\n\t */\n\tpublic get width(): number {\n\t\treturn this.canvas.width;\n\t}\n\n\tpublic set width(value: number) {\n\t\tthis.canvas.width = value;\n\t}\n\n\t/**\n\t * The image height of this canvas\n\t * @since 0.0.1\n\t */\n\tpublic get height(): number {\n\t\treturn this.canvas.height;\n\t}\n\n\tpublic set height(value: number) {\n\t\tthis.canvas.height = value;\n\t}\n\n\t/**\n\t * The font height\n\t * @sinc 3.0.0\n\t */\n\tpublic get textFontHeight(): number {\n\t\treturn getFontHeight(this.context.font);\n\t}\n\n\t/**\n\t * Change the current canvas' size.\n\t * @param width The new width for the canvas.\n\t * @param height The new height for the canvas.\n\t */\n\tpublic changeCanvasSize(width: number, height: number): this {\n\t\treturn this.changeCanvasWidth(width).changeCanvasHeight(height);\n\t}\n\n\t/**\n\t * Change the current canvas' width.\n\t * @param width The new width for the canvas.\n\t */\n\tpublic changeCanvasWidth(width: number): this {\n\t\tthis.width = width;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Change the current canvas' height.\n\t * @param height The new height for the canvas.\n\t */\n\tpublic changeCanvasHeight(height: number): this {\n\t\tthis.height = height;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Save the entire state of the canvas by pushing the current state onto a stack.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/save\n\t */\n\tpublic save(): this {\n\t\tthis.context.save();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Restores the most recently saved canvas by popping the top entry in the drawing state stack. If there is no saved\n\t * state, this method does nothing.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/restore\n\t */\n\tpublic restore(): this {\n\t\tthis.context.restore();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a rotation to the transformation matrix. The angle argument represents a clockwise rotation angle and is\n\t * expressed in radians.\n\t * @param angle The angle to rotate clockwise in radians.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/rotate\n\t */\n\tpublic rotate(angle: number): this {\n\t\tthis.context.rotate(angle);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a scaling transformation to the canvas units by X horizontally and by y vertically.\n\t * @param x Scaling factor in the horizontal direction.\n\t * @param y Scaling factor in the vertical direction.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/scale\n\t */\n\tpublic scale(x: number, y: number): this {\n\t\tthis.context.scale(x, y);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a translation transformation by moving the canvas and its origin X horizontally and y vertically on the grid.\n\t * @param x Distance to move in the horizontal direction.\n\t * @param y Distance to move in the vertical direction.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/translate\n\t */\n\tpublic translate(x: number, y: number): this {\n\t\tthis.context.translate(x, y);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Turns the path currently being built into the current clipping path.\n\t * @param fillRule The algorithm by which to determine if a point is inside a path or outside a path.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/clip\n\t */\n\tpublic clip(fillRule?: CanvasFillRule): this {\n\t\tthis.context.clip(fillRule);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Resets (overrides) the current transformation to the identity matrix and then invokes a transformation described\n\t * by the arguments of this method.\n\t * @param a Horizontal scaling.\n\t * @param b Horizontal skewing.\n\t * @param c Vertical skewing.\n\t * @param d Vertical scaling.\n\t * @param e Horizontal moving.\n\t * @param f Vertical moving.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setTransform\n\t */\n\tpublic setTransform(a: number, b: number, c: number, d: number, e: number, f: number): this;\n\t/**\n\t * Resets (overrides) the current transformation to the identity matrix and then invokes a transformation described\n\t * by the arguments of this method.\n\t * @param matrix The new transform matrix.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setTransform\n\t */\n\tpublic setTransform(transform?: DOMMatrix): this;\n\tpublic setTransform(...args: readonly any[]): this {\n\t\tthis.context.setTransform(...args);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Reset the transformation.\n\t */\n\tpublic resetTransformation(): this {\n\t\treturn this.setTransform(1, 0, 0, 1, 0, 0);\n\t}\n\n\t/**\n\t * Returns an ImageData object representing the underlying pixel data for the area of the canvas\n\t * denoted by the entire Canvas. This method is not affected by the canvas transformation matrix.\n\t * @param callback The callback to be called.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getImageData\n\t */\n\tpublic getImageData(): ImageData;\n\t/**\n\t * Calls the callback with an ImageData object representing the underlying pixel data for the area of the canvas\n\t * denoted by the entire Canvas. This method is not affected by the canvas transformation matrix.\n\t * @param callback The callback to be called.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getImageData\n\t */\n\tpublic getImageData(callback: ImageDataCallback): this;\n\t/**\n\t * Returns an ImageData object representing the underlying pixel data for the area of the canvas denoted by the rectangle which starts at (sx, sy)\n\t * and has an sw width and sh height. This method is not affected by the canvas transformation matrix.\n\t * @param x The X coordinate of the upper left corner of the rectangle from which the ImageData will be extracted.\n\t * @param y The Y coordinate of the upper left corner of the rectangle from which the ImageData will be extracted.\n\t * @param width The width of the rectangle from which the ImageData will be extracted.\n\t * @param height The height of the rectangle from which the ImageData will be extracted.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getImageData\n\t */\n\tpublic getImageData(x: number, y: number, width: number, height: number): ImageData;\n\t/**\n\t * Calls the callback with an ImageData object representing the underlying pixel data for the area of the canvas\n\t * denoted by the rectangle which starts at (x, y) and has an sw width and sh height. This method is not affected by\n\t * the canvas transformation matrix.\n\t * @param x The X coordinate of the upper left corner of the rectangle from which the ImageData will be extracted.\n\t * @param y The Y coordinate of the upper left corner of the rectangle from which the ImageData will be extracted.\n\t * @param width The width of the rectangle from which the ImageData will be extracted.\n\t * @param height The height of the rectangle from which the ImageData will be extracted.\n\t * @param callback The callback to be called.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getImageData\n\t */\n\tpublic getImageData(x: number, y: number, width: number, height: number, callback: ImageDataCallback): this;\n\tpublic getImageData(x?: number | ImageDataCallback, y?: number, width?: number, height?: number, callback?: ImageDataCallback): this | ImageData {\n\t\tif (typeof x === 'function') {\n\t\t\tcallback = x;\n\t\t\tx = 0;\n\t\t}\n\t\tif (callback) {\n\t\t\tif (typeof callback !== 'function') throw new TypeError('Callback must be a function');\n\t\t\tcallback.call(this, this.context.getImageData(x ?? 0, y ?? 0, width ?? this.width, height ?? this.height), this);\n\t\t\treturn this;\n\t\t}\n\n\t\treturn this.context.getImageData(x ?? 0, y ?? 0, width ?? this.width, height ?? this.height);\n\t}\n\n\t/**\n\t * The CanvasRenderingContext2D.putImageData() method of the Canvas 2D API paints data from the given ImageData object onto the bitmap.\n\t * This method is not affected by the canvas transformation matrix.\n\t * @param imagedata An ImageData object containing the array of pixel values.\n\t * @param dx Horizontal position (x-coordinate) at which to place the image data in the destination canvas.\n\t * @param dy Vertical position (y-coordinate) at which to place the image data in the destination canvas.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/putImageData\n\t */\n\tpublic putImageData(imagedata: ImageData, dx: number, dy: number): this;\n\t/**\n\t * The CanvasRenderingContext2D.putImageData() method of the Canvas 2D API paints data from the given ImageData object onto the bitmap.\n\t * Only the pixels from that rectangle are painted.\n\t * This method is not affected by the canvas transformation matrix.\n\t * @param imagedata An ImageData object containing the array of pixel values.\n\t * @param x Horizontal position (x-coordinate) at which to place the image data in the destination canvas.\n\t * @param y Vertical position (y-coordinate) at which to place the image data in the destination canvas.\n\t * @param dirtyX Horizontal position (x-coordinate). The X coordinate of the top left hand corner of your Image data. Defaults to 0.\n\t * @param dirtyY Vertical position (y-coordinate). The Y coordinate of the top left hand corner of your Image data. Defaults to 0.\n\t * @param dirtyWidth Width of the rectangle to be painted. Defaults to the width of the image data.\n\t * @param dirtyHeight Height of the rectangle to be painted. Defaults to the height of the image data.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/putImageData\n\t */\n\tpublic putImageData(imagedata: ImageData, x: number, y: number, dirtyX: number, dirtyY: number, dirtyWidth: number, dirtyHeight: number): this;\n\n\tpublic putImageData(...args: readonly any[]): this {\n\t\t// @ts-expect-error: Complains about invalid overload (expects more than 0 overloads).\n\t\tthis.context.putImageData(...args);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Fills the current or given path with the current fill style using the non-zero or even-odd winding rule.\n\t * @param fillRule The algorithm by which to determine if a point is inside a path or outside a path.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fill\n\t */\n\tpublic fill(fillRule?: CanvasFillRule): this {\n\t\tthis.context.fill(fillRule);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add a text.\n\t * @param text The text to write.\n\t * @param dx The position x to start drawing the element.\n\t * @param dy The position y to start drawing the element.\n\t * @param maxWidth The maximum width to draw. If specified, and the string is computed to be wider than this width,\n\t * the font is adjusted to use a more horizontally condensed font.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillText\n\t */\n\tpublic printText(text: string, x: number, y: number, maxWidth?: number): this;\n\tpublic printText(text: string, x: number, y: number, ...rest: readonly any[]): this {\n\t\tthis.context.fillText(text, x, y, ...rest);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add responsive text\n\t * @param text The text to write.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @param maxWidth The max length in pixels for the text.\n\t * @example\n\t * new Canvas(400, 300)\n\t *     .setTextFont('40px Tahoma')\n\t *     .printResponsiveText('Hello World', 30, 30, 50)\n\t *     .toBuffer();\n\t */\n\tpublic printResponsiveText(text: string, x: number, y: number, maxWidth: number): this {\n\t\tconst [, style = '', size, font] = /(\\w+ )?(\\d+)(.+)/.exec(this.context.font) ?? [];\n\t\tconst currentSize = parseInt(size, 10);\n\t\tconst { width } = this.measureText(text);\n\t\tconst newLength = maxWidth > width ? currentSize : (maxWidth / width) * currentSize;\n\t\treturn this.setTextFont(`${style}${newLength}${font}`).printText(text, x, y);\n\t}\n\n\t/**\n\t * Add text with line breaks (node-canvas and web canvas compatible)\n\t * @param text The text to write.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @example\n\t * new Canvas(400, 300)\n\t *     .setTextFont('25px Tahoma')\n\t *     .printMultilineText('This is a really\\nlong text!', 139, 360)\n\t *     .toBuffer();\n\t */\n\tpublic printMultilineText(text: string, x: number, y: number): this {\n\t\tconst lines = text.split(/\\r?\\n/);\n\n\t\t// If there are no new lines, return using printText\n\t\tif (lines.length <= 1) return this.printText(text, x, y);\n\n\t\tconst height = this.textFontHeight;\n\n\t\tlet linePositionY = y;\n\t\tfor (const line of lines) {\n\t\t\tthis.printText(line, x, Math.floor(linePositionY));\n\t\t\tlinePositionY += height;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Wrap the text in multiple lines and write it\n\t * @param text The text to wrap and write.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @param wrapWidth The width in pixels of the line wrap\n\t * @example\n\t * new Canvas(400, 300)\n\t *     .setTextFont('25px Tahoma')\n\t *     .printWrappedText('This is a really long text!', 139, 360)\n\t *     .toBuffer();\n\t */\n\tpublic printWrappedText(text: string, x: number, y: number, wrapWidth: number): this {\n\t\tconst wrappedText = textWrap(this, text, wrapWidth);\n\t\treturn this.printMultilineText(wrappedText, x, y);\n\t}\n\n\t/**\n\t * Strokes the current or given path with the current stroke style using the non-zero winding rule.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/stroke\n\t */\n\tpublic stroke(): this {\n\t\tthis.context.stroke();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Paints a rectangle which has a starting point at (X, Y) and has a w width and an h height onto the canvas, using\n\t * the current stroke style.\n\t * @param x The x axis of the coordinate for the rectangle starting point.\n\t * @param y The y axis of the coordinate for the rectangle starting point.\n\t * @param width The rectangle's width.\n\t * @param height The rectangle's height.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/strokeRect\n\t */\n\tpublic printStrokeRect(x: number, y: number, width: number, height: number): this {\n\t\tthis.context.strokeRect(x, y, width, height);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add stroked text.\n\t * @param text The text to write.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @param maxWidth The maximum width to draw. If specified, and the string is computed to be wider than this width,\n\t * the font is adjusted to use a more horizontally condensed font.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/strokeText\n\t */\n\tpublic printStrokeText(text: string, x: number, y: number, maxWidth?: number): this {\n\t\tthis.context.strokeText(text, x, y, maxWidth);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Measure a text's width given a string.\n\t * @param text The text to measure.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/measureText\n\t * @example\n\t * const size = new Canvas(500, 400)\n\t *     .setTextFont('40px Tahoma')\n\t *     .measureText('Hello World!'); // Returns a number\n\t *\n\t * const newSize = size.width < 500 ? 40 : (500 / size.width) * 40;\n\t *\n\t * new Canvas(500, 400)\n\t *     .setTextFont(`${newSize}px Tahoma`)\n\t *     .printText('Hello World!', 30, 50)\n\t *     .toBuffer(); // Returns a Buffer\n\t */\n\tpublic measureText(text: string): TextMetrics;\n\t/**\n\t * Measure a text's width given a string.\n\t * @param text The text to measure.\n\t * @param callback The callback, if not specified, this method won't be chainable as it will return a\n\t * number. If you use an arrow function, you might want to use the second argument which is the instance of the\n\t * class. Otherwise, the keyword this is binded to the class instance itself, so you can use it safely.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/measureText\n\t * @example\n\t * new Canvas(500, 400)\n\t *     .setTextFont('40px Tahoma')\n\t *     .measureText('Hello World!', function(size) {\n\t *         const newSize = size.width < 500 ? 40 : (500 / size.width) * 40;\n\t *         this.setTextFont(`${newSize}px Tahoma`);\n\t *     })\n\t *     .printText('Hello World!', 30, 50)\n\t *     .toBuffer(); // Returns a Buffer\n\t * @example\n\t * new Canvas(500, 400)\n\t *     .setTextFont('40px Tahoma')\n\t *     .measureText('Hello World!', (size, inst) => {\n\t *         const newSize = size.width < 500 ? 40 : (500 / size.width) * 40;\n\t *         inst.setTextFont(`${newSize}px`);\n\t *     })\n\t *     .printText('Hello World!', 30, 50)\n\t *     .toBuffer(); // Returns a Buffer\n\t */\n\tpublic measureText(text: string, callback: MeasureTextCallback): this;\n\tpublic measureText(text: string, callback?: MeasureTextCallback): this | TextMetrics {\n\t\tif (callback) {\n\t\t\tif (typeof callback !== 'function') throw new TypeError('Callback must be a function.');\n\t\t\tcallback.call(this, this.context.measureText(text), this);\n\t\t\treturn this;\n\t\t}\n\t\treturn this.context.measureText(text);\n\t}\n\n\t/**\n\t * Set the new font size, unlike setTextFont, this only requires the number.\n\t * @param size The new size to set\n\t */\n\tpublic setTextSize(size: number): this {\n\t\tconst [, style = '', font] = /(\\w+ )?(?:\\d+)(.+)/.exec(this.context.font) ?? [];\n\t\treturn this.setTextFont(`${style}${size}${font}`);\n\t}\n\n\t/**\n\t * Specifies the color or style to use for the lines around shapes.\n\t * @param color A canvas' color resolvable.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/strokeStyle\n\t */\n\tpublic setStroke(color: string | CanvasGradient | CanvasPattern): this {\n\t\tthis.context.strokeStyle = color;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the thickness of lines in space units.\n\t * @param width A number specifying the line width in space units.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineWidth\n\t */\n\tpublic setLineWidth(width: number): this {\n\t\tthis.context.lineWidth = width;\n\t\treturn this;\n\t}\n\n\tpublic setStrokeWidth(width: number): this {\n\t\treturn this.setLineWidth(width);\n\t}\n\n\t/**\n\t * Sets the line dash pattern offset or \"phase\" to achieve a \"marching ants\" effect\n\t * @param value A float specifying the amount of the offset. Initially 0.0.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineDashOffset\n\t */\n\tpublic setLineDashOffset(value: number): this {\n\t\tthis.context.lineDashOffset = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Determines how two connecting segments (of lines, arcs or curves) with non-zero lengths in a shape are joined\n\t * together (degenerate segments with zero lengths, whose specified endpoints and control points are exactly at the\n\t * same position, are skipped).\n\t * @param value The line join type.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineJoin\n\t */\n\tpublic setLineJoin(value: CanvasLineJoin): this {\n\t\tthis.context.lineJoin = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Determines how the end points of every line are drawn. There are three possible values for this property and\n\t * those are: butt, round and square. By default this property is set to butt.\n\t * @param value The line join type.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineCap\n\t */\n\tpublic setLineCap(value: CanvasLineCap): this {\n\t\tthis.context.lineCap = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the line dash pattern used when stroking lines, using an array of values which specify alternating lengths\n\t * of lines and gaps which describe the pattern.\n\t * @param segments An Array of numbers which specify distances to alternately draw a line and a gap (in coordinate\n\t * space units). If the number of elements in the array is odd, the elements of the array get copied and\n\t * concatenated. For example, [5, 15, 25] will become [5, 15, 25, 5, 15, 25]. If the array is empty, the line dash\n\t * list is cleared and line strokes return to being solid.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash\n\t */\n\tpublic setLineDash(segments: number[]): this {\n\t\tthis.context.setLineDash(segments);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add an image at a position (x, y) with the source image's width and height.\n\t * @param imageOrBuffer The image's buffer.\n\t * @param x The X coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @param y The Y coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage\n\t */\n\tpublic printImage(imageOrBuffer: ImageResolvable, x: number, y: number): this;\n\t/**\n\t * Add an image at a position (x, y) with a given width and height.\n\t * @param imageOrBuffer The image's buffer.\n\t * @param x The X coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @param y The Y coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @param width The width to draw the image in the destination canvas. This allows scaling of the drawn image. If not specified, the image is not scaled in width when drawn.\n\t * @param height The height to draw the image in the destination canvas. This allows scaling of the drawn image. If not specified, the image is not scaled in height when drawn.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage\n\t */\n\tpublic printImage(imageOrBuffer: ImageResolvable, x: number, y: number, width: number, height: number): this;\n\t/**\n\t * Add an image at a position (x, y) with a given width and height, from a specific source rectangle.\n\t * @param imageOrBuffer The image's buffer.\n\t * @param x The X coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @param y The Y coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @param width The width to draw the image in the destination canvas. This allows scaling of the drawn image. If not specified, the image is not scaled in width when drawn.\n\t * @param height The height to draw the image in the destination canvas. This allows scaling of the drawn image. If not specified, the image is not scaled in height when drawn.\n\t * @param sourceX The X coordinate of the top left corner of the sub-rectangle of the source image to draw into the destination context.\n\t * @param sourceY The Y coordinate of the top left corner of the sub-rectangle of the source image to draw into the destination context.\n\t * @param sourceWidth The width of the sub-rectangle of the source image to draw into the destination context. If not specified, the entire rectangle from the coordinates specified by sx and sy to the bottom-right corner of the image is used.\n\t * @param sourceHeight The height of the sub-rectangle of the source image to draw into the destination context.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage\n\t */\n\tpublic printImage(\n\t\timageOrBuffer: ImageResolvable,\n\t\tsx: number,\n\t\tsy: number,\n\t\tsw: number,\n\t\tsh: number,\n\t\tdx: number,\n\t\tdy: number,\n\t\tdw: number,\n\t\tdh: number\n\t): this;\n\n\tpublic printImage(image: ImageResolvable, ...args: readonly any[]) {\n\t\tthis.context.drawImage(image, ...args);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add a round image.\n\t * @param imageOrBuffer The image's buffer.\n\t * @param x The X coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @param y The Y coordinate in the destination canvas at which to place the top-left corner of the source image.\n\t * @param width The width to draw the image in the destination canvas. This allows scaling of the drawn image. If not specified, the image is not scaled in width when drawn.\n\t * @param height The height to draw the image in the destination canvas. This allows scaling of the drawn image. If not specified, the image is not scaled in height when drawn.\n\t * @param radius The radius for the circle\n\t */\n\tpublic printCircularImage(imageOrBuffer: ImageResolvable, x: number, y: number, width: number, height: number, radius: number): this {\n\t\treturn this.save()\n\t\t\t.createCircularClip(x, y, radius, 0, Math.PI * 2, false)\n\t\t\t.printImage(imageOrBuffer, x - radius, y - radius, width, height)\n\t\t\t.restore();\n\t}\n\n\t/**\n\t * Add a beveled image.\n\t * @param imageOrBuffer The image's buffer.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @param width The width of the element.\n\t * @param height The height of the element.\n\t * @param radius The radius for the new image.\n\t */\n\tpublic printRoundedImage(\n\t\timageOrBuffer: ImageResolvable,\n\t\tx: number,\n\t\ty: number,\n\t\twidth: number,\n\t\theight: number,\n\t\tradius: BeveledRadiusOptions | number\n\t): this {\n\t\treturn this.save().createBeveledClip(x, y, width, height, radius).printImage(imageOrBuffer, x, y, width, height).restore();\n\t}\n\n\t/**\n\t * Add a circle or semi circle.\n\t * @param x The position x in the center of the circle.\n\t * @param y The position y in the center of the ircle.\n\t * @param radius The radius for the clip.\n\t */\n\tpublic printCircle(x: number, y: number, radius: number): this {\n\t\treturn this.save().createCircularPath(x, y, radius).fill().restore();\n\t}\n\n\t/**\n\t * Add a rectangle.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @param width The width of the element.\n\t * @param height The height of the element.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillRect\n\t */\n\tpublic printRectangle(x: number, y: number, width: number, height: number): this {\n\t\tthis.context.fillRect(x, y, width, height);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Add a beveled rectangle.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @param width  The width of the element.\n\t * @param height The height of the element.\n\t * @param radius The radius for the bevels.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillRect\n\t * @example\n\t * // Radius argument\n\t * new Canvas(200, 200)\n\t *     .printRoundedRectangle(0, 0, 200, 50, 35)\n\t *     .toBuffer();\n\t *\n\t * @example\n\t * // Configured bevels\n\t * new Canvas(200, 200)\n\t *     .printRoundedRectangle(0, 0, 200, 50, {\n\t *         // Top left border\n\t *         tl: 15,\n\t *         // Top right border\n\t *         tr: 20,\n\t *         // Bottom left border\n\t *         bl: 5,\n\t *         // Bottom right border\n\t *         br: 10\n\t *     })\n\t *     .toBuffer();\n\t *\n\t * @example\n\t * // Top bevels only\n\t * new Canvas(200, 200)\n\t *     .printRoundedRectangle(0, 0, 200, 50, { tl: 20, tr: 20, bl: 0, br: 0 })\n\t *     .toBuffer();\n\t */\n\tpublic printRoundedRectangle(x: number, y: number, width: number, height: number, radius: number | BeveledRadiusOptions): this {\n\t\treturn this.save().createBeveledPath(x, y, width, height, radius).fill().restore();\n\t}\n\n\t/**\n\t * Create a round path.\n\t * @param dx The position x in the center of the clip's circle.\n\t * @param dy The position y in the center of the clip's circle.\n\t * @param radius The radius for the clip.\n\t * @param start The degree in radians to start drawing the circle.\n\t * @param angle The degree in radians to finish drawing the circle, defaults to a full circle.\n\t * @param antiClockwise Whether the path should be anti-clockwise.\n\t */\n\tpublic createCircularPath(dx: number, dy: number, radius: number, start = 0, angle = Math.PI * 2, antiClockwise = false): this {\n\t\tthis.context.beginPath();\n\t\tthis.context.arc(dx, dy, radius, start, angle, antiClockwise);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Create a round clip.\n\t * @param dx The position x in the center of the clip's circle.\n\t * @param dy The position y in the center of the clip's circle.\n\t * @param radius The radius for the clip.\n\t * @param start The degree in radians to start drawing the circle.\n\t * @param angle The degree in radians to finish drawing the circle, defaults to a full circle.\n\t * @param antiClockwise Whether the path should be anti-clockwise.\n\t * @see createRoundPath\n\t */\n\tpublic createCircularClip(dx: number, dy: number, radius: number, start?: number, angle?: number, antiClockwise?: boolean): this {\n\t\treturn this.createCircularPath(dx, dy, radius, start, angle, antiClockwise).clip();\n\t}\n\n\t/**\n\t * Create a rectangle path.\n\t * @param x The position x in the left corner.\n\t * @param y The position y in the upper corner.\n\t * @param width The width of the rectangle.\n\t * @param height The height of the rectangle.\n\t */\n\tpublic createRectanglePath(x: number, y: number, width: number, height: number): this {\n\t\tthis.context.rect(x, y, width, height);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Create a rectangle clip.\n\t * @param x The position x in the left corner.\n\t * @param y The position y in the upper corner.\n\t * @param width The width of the rectangle.\n\t * @param height The height of the rectangle.\n\t */\n\tpublic createRectangleClip(x: number, y: number, width: number, height: number): this {\n\t\treturn this.createRectanglePath(x, y, width, height).clip();\n\t}\n\n\t/**\n\t * Create a beveled path.\n\t * @param x The position x to start drawing clip.\n\t * @param y The position y to start drawing clip.\n\t * @param width The width of clip.\n\t * @param height The height of clip.\n\t * @param radius The radius for clip's rounded borders.\n\t */\n\tpublic createBeveledPath(x: number, y: number, width: number, height: number, radius: number | BeveledRadiusOptions): this {\n\t\tif (width > 0 && height > 0) {\n\t\t\tlet radiusObject: BeveledRadiusOptions | undefined = undefined;\n\t\t\tif (typeof radius === 'number') {\n\t\t\t\tradius = Math.min(radius, width / 2, height / 2);\n\t\t\t\tradiusObject = { tl: radius, tr: radius, br: radius, bl: radius };\n\t\t\t} else {\n\t\t\t\tradiusObject = radius;\n\t\t\t\tradius = Math.min(5, width / 2, height / 2);\n\t\t\t}\n\t\t\tconst { tl = radius, tr = radius, br = radius, bl = radius } = radiusObject;\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.moveTo(x + tl, y);\n\t\t\tthis.context.lineTo(x + width - tr, y);\n\t\t\tthis.context.quadraticCurveTo(x + width, y, x + width, y + tr);\n\t\t\tthis.context.lineTo(x + width, y + height - br);\n\t\t\tthis.context.quadraticCurveTo(x + width, y + height, x + width - br, y + height);\n\t\t\tthis.context.lineTo(x + bl, y + height);\n\t\t\tthis.context.quadraticCurveTo(x, y + height, x, y + height - bl);\n\t\t\tthis.context.lineTo(x, y + tl);\n\t\t\tthis.context.quadraticCurveTo(x, y, x + tl, y);\n\t\t\tthis.context.closePath();\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Create a beveled clip.\n\t * @param x The position x to start drawing clip.\n\t * @param y The position y to start drawing clip.\n\t * @param width The width of clip.\n\t * @param height The height of clip.\n\t * @param radius The radius for clip's rounded borders.\n\t * @example\n\t * // Radius argument, fill the content\n\t * new Canvas(200, 200)\n\t *     .createBeveledClip(0, 0, 200, 50, 35)\n\t *     .fill()\n\t *     .toBuffer();\n\t *\n\t * @example\n\t * // Configured bevels\n\t * new Canvas(200, 200)\n\t *     .createBeveledClip(0, 0, 200, 50, {\n\t *         // Top left border\n\t *         tl: 15,\n\t *         // Top right border\n\t *         tr: 20,\n\t *         // Bottom left border\n\t *         bl: 5,\n\t *         // Bottom right border\n\t *         br: 10\n\t *     })\n\t *     // Add an image with the shape of the beveled clip using different borders\n\t *     .printImage(buffer, 0, 0, 200, 50)\n\t *     .toBuffer();\n\t *\n\t * @example\n\t * // Top bevels only\n\t * new Canvas(200, 200)\n\t *     .createBeveledClip(0, 0, 200, 50, { tl: 20, tr: 20, bl: 0, br: 0 })\n\t *     .printImage(buffer, 0, 0, 200, 50)\n\t *     .toBuffer();\n\t */\n\tpublic createBeveledClip(x: number, y: number, width: number, height: number, radius: number | BeveledRadiusOptions): this {\n\t\treturn this.createBeveledPath(x, y, width, height, radius).clip();\n\t}\n\n\t/**\n\t * Set a color for the canvas' context.\n\t * @param color A canvas' color resolvable.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillStyle\n\t */\n\tpublic setColor(color: string | CanvasGradient | CanvasPattern): this {\n\t\tthis.context.fillStyle = color;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Change the font.\n\t * @param font The font's name to set.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font\n\t */\n\tpublic setTextFont(font: string): this {\n\t\tthis.context.font = font;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Change the font alignment.\n\t * @param align The font's alignment to set.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textAlign\n\t */\n\tpublic setTextAlign(align: CanvasTextAlign): this {\n\t\tthis.context.textAlign = align;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Change the font's baseline.\n\t * @param baseline The font's baseline to set.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textBaseline\n\t */\n\tpublic setTextBaseline(baseline: CanvasTextBaseline): this {\n\t\tthis.context.textBaseline = baseline;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Starts a new path by emptying the list of sub-paths.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/beginPath\n\t */\n\tpublic beginPath(): this {\n\t\tthis.context.beginPath();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the point of the pen to move back to the start of the current sub-path.\n\t * If the shape has already been closed or has only one point, this function does nothing.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/closePath\n\t */\n\tpublic closePath(): this {\n\t\tthis.context.closePath();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Creates a pattern using the specified image. It repeats the source in the directions specified by the repetition\n\t * argument, and returns it.\n\t * @param image A Canvas Image to be used as the image to repeat.\n\t * @param repetition The repeat mode.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createPattern\n\t */\n\tpublic createPattern(image: Canvas | Image, repetition: PatternRepeat): CanvasPattern;\n\t/**\n\t * Creates a pattern using the specified image. It repeats the source in the directions specified by the repetition\n\t * argument, and calls the callback.\n\t * @param image A Canvas Image to be used as the image to repeat.\n\t * @param repetition The repeat mode.\n\t * @param callback The callback to take the createPattern.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createPattern\n\t */\n\tpublic createPattern(image: Canvas | Image, repetition: PatternRepeat, callback: PatternCallback): this;\n\tpublic createPattern(image: Canvas | Image, repetition: PatternRepeat, callback?: PatternCallback): CanvasPattern | this {\n\t\tconst pattern = this.context.createPattern(image, repetition);\n\t\tif (callback) {\n\t\t\tcallback.call(this, pattern, this);\n\t\t\treturn this;\n\t\t}\n\n\t\treturn pattern;\n\t}\n\n\t/**\n\t * Creates a pattern using the specified image. It repeats the source in the directions specified by the repetition\n\t * argument, and prints it.\n\t * @param image A Canvas Image to be used as the image to repeat.\n\t * @param repetition The repeat mode.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createPattern\n\t */\n\tpublic printPattern(image: ImageResolvable, repetition: PatternRepeat): this {\n\t\treturn this.createPattern(image, repetition, (pattern) => this.setColor(pattern));\n\t}\n\n\t/**\n\t * Creates a gradient along the line given by the coordinates represented by the parameters.\n\t * The coordinates are global, the second point does not rely on the position of the first and vice versa.\n\t * @param x0 The x axis of the coordinate of the start point.\n\t * @param y0 The y axis of the coordinate of the start point.\n\t * @param x1 The x axis of the coordinate of the end point.\n\t * @param y1 The y axis of the coordinate of the end point.\n\t * @param steps The gradient steps.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\n\t */\n\tpublic createLinearGradient(x0: number, y0: number, x1: number, y1: number, steps: readonly GradientStop[] = []): CanvasGradient {\n\t\tconst gradient = this.context.createLinearGradient(x0, y0, x1, y1);\n\t\tfor (const step of steps) {\n\t\t\tgradient.addColorStop(step.position, step.color);\n\t\t}\n\n\t\treturn gradient;\n\t}\n\n\t/**\n\t * Creates a gradient along the line given by the coordinates represented by the parameters.\n\t * The coordinates are global, the second point does not rely on the position of the first and vice versa. This\n\t * method is chainable and calls setColor after creating the gradient.\n\t * @param x0 The x axis of the coordinate of the start point.\n\t * @param y0 The y axis of the coordinate of the start point.\n\t * @param x1 The x axis of the coordinate of the end point.\n\t * @param y1 The y axis of the coordinate of the end point.\n\t * @param steps The gradient steps.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\n\t * @example\n\t * new Canvas(200, 200)\n\t *     .printLinearColorGradient(0, 0, 200, 50, [\n\t *         { position: 0, color: 'white' },\n\t *         { position: 0.25, color: 'red' },\n\t *         { position: 0.5, color: 'blue' }\n\t *     ])\n\t *     .printRectangle(10, 10, 200, 100)\n\t */\n\tpublic printLinearColorGradient(x0: number, y0: number, x1: number, y1: number, steps?: readonly GradientStop[]): this {\n\t\tconst gradient = this.createLinearGradient(x0, y0, x1, y1, steps);\n\t\treturn this.setColor(gradient);\n\t}\n\n\t/**\n\t * Creates a gradient along the line given by the coordinates represented by the parameters.\n\t * The coordinates are global, the second point does not rely on the position of the first and vice versa. This\n\t * method is chainable and calls setStroke after creating the gradient.\n\t * @param x0 The x axis of the coordinate of the start point.\n\t * @param y0 The y axis of the coordinate of the start point.\n\t * @param x1 The x axis of the coordinate of the end point.\n\t * @param y1 The y axis of the coordinate of the end point.\n\t * @param steps The gradient steps.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\n\t * @example\n\t * new Canvas(200, 200)\n\t *     .printLinearStrokeGradient(0, 0, 200, 50, [\n\t *         { position: 0, color: 'white' },\n\t *         { position: 0.25, color: 'red' },\n\t *         { position: 0.5, color: 'blue' }\n\t *     ])\n\t *     .printRectangle(10, 10, 200, 100)\n\t */\n\tpublic printLinearStrokeGradient(x0: number, y0: number, x1: number, y1: number, steps?: readonly GradientStop[]): this {\n\t\tconst gradient = this.createLinearGradient(x0, y0, x1, y1, steps);\n\t\treturn this.setStroke(gradient);\n\t}\n\n\t/**\n\t * Creates a radial gradient given by the coordinates of the two circles represented by the parameters.\n\t * @param x0 The x axis of the coordinate of the start circle.\n\t * @param y0 The y axis of the coordinate of the start circle.\n\t * @param r0 The radius of the start circle.\n\t * @param x1 The x axis of the coordinate of the end circle.\n\t * @param y1 The y axis of the coordinate of the end circle.\n\t * @param r1 The radius of the end circle.\n\t * @param steps The gradient steps.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\n\t */\n\tpublic createRadialGradient(\n\t\tx0: number,\n\t\ty0: number,\n\t\tr0: number,\n\t\tx1: number,\n\t\ty1: number,\n\t\tr1: number,\n\t\tsteps: readonly GradientStop[] = []\n\t): CanvasGradient {\n\t\tconst gradient = this.context.createRadialGradient(x0, y0, r0, x1, y1, r1);\n\t\tfor (const step of steps) {\n\t\t\tgradient.addColorStop(step.position, step.color);\n\t\t}\n\n\t\treturn gradient;\n\t}\n\n\t/**\n\t * Creates a radial gradient given by the coordinates of the two circles represented by the parameters. This\n\t * method is chainable and calls setColor after creating the gradient.\n\t * @param x0 The x axis of the coordinate of the start circle.\n\t * @param y0 The y axis of the coordinate of the start circle.\n\t * @param r0 The radius of the start circle.\n\t * @param x1 The x axis of the coordinate of the end circle.\n\t * @param y1 The y axis of the coordinate of the end circle.\n\t * @param r1 The radius of the end circle.\n\t * @param steps The gradient steps.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\n\t */\n\tpublic printRadialColorGradient(x0: number, y0: number, r0: number, x1: number, y1: number, r1: number, steps?: readonly GradientStop[]): this {\n\t\tconst gradient = this.createRadialGradient(x0, y0, r0, x1, y1, r1, steps);\n\t\treturn this.setColor(gradient);\n\t}\n\n\t/**\n\t * Creates a radial gradient given by the coordinates of the two circles represented by the parameters. This\n\t * method is chainable and calls setStroke after creating the gradient.\n\t * @param x0 The x axis of the coordinate of the start circle.\n\t * @param y0 The y axis of the coordinate of the start circle.\n\t * @param r0 The radius of the start circle.\n\t * @param x1 The x axis of the coordinate of the end circle.\n\t * @param y1 The y axis of the coordinate of the end circle.\n\t * @param r1 The radius of the end circle.\n\t * @param steps The gradient steps.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\n\t */\n\tpublic printRadialStrokeGradient(x0: number, y0: number, r0: number, x1: number, y1: number, r1: number, steps?: readonly GradientStop[]): this {\n\t\tconst gradient = this.createRadialGradient(x0, y0, r0, x1, y1, r1, steps);\n\t\treturn this.setStroke(gradient);\n\t}\n\n\t/**\n\t * Adds an ellipse to the path which is centered at (X, Y) position with the radius radiusX and radiusY starting at\n\t * startAngle and ending at endAngle going in the given direction by anticlockwise (defaulting to clockwise).\n\t * @param x The x axis of the coordinate for the ellipse's center.\n\t * @param y The y axis of the coordinate for the ellipse's center.\n\t * @param radiusX The ellipse's major-axis radius.\n\t * @param radiusY The ellipse's minor-axis radius.\n\t * @param rotation The rotation for this ellipse, expressed in radians.\n\t * @param startAngle The starting point, measured from the x axis, from which it will be drawn, expressed in radians.\n\t * @param endAngle The end ellipse's angle to which it will be drawn, expressed in radians.\n\t * @param anticlockwise An optional Boolean which, if true, draws the ellipse anticlockwise (counter-clockwise), otherwise in a clockwise direction.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n\t */\n\tpublic createEllipsePath(\n\t\tx: number,\n\t\ty: number,\n\t\tradiusX: number,\n\t\tradiusY: number,\n\t\trotation: number,\n\t\tstartAngle: number,\n\t\tendAngle: number,\n\t\tanticlockwise?: boolean\n\t): this {\n\t\tthis.context.ellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Creates an ellipse clip which is centered at (X, Y) position with the radius radiusX and radiusY starting at\n\t * startAngle and ending at endAngle going in the given direction by anticlockwise (defaulting to clockwise).\n\t * @param x The x axis of the coordinate for the ellipse's center.\n\t * @param y The y axis of the coordinate for the ellipse's center.\n\t * @param radiusX The ellipse's major-axis radius.\n\t * @param radiusY The ellipse's minor-axis radius.\n\t * @param rotation The rotation for this ellipse, expressed in radians.\n\t * @param startAngle The starting point, measured from the x axis, from which it will be drawn, expressed in radians.\n\t * @param endAngle The end ellipse's angle to which it will be drawn, expressed in radians.\n\t * @param anticlockwise An optional Boolean which, if true, draws the ellipse anticlockwise (counter-clockwise), otherwise in a clockwise direction.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n\t */\n\tpublic createEllipseClip(\n\t\tx: number,\n\t\ty: number,\n\t\tradiusX: number,\n\t\tradiusY: number,\n\t\trotation: number,\n\t\tstartAngle: number,\n\t\tendAngle: number,\n\t\tanticlockwise?: boolean\n\t): this {\n\t\treturn this.createEllipsePath(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise).clip();\n\t}\n\n\t/**\n\t * Adds an arc to the path which is centered at (X, Y) position with radius r starting at startAngle and ending at\n\t * endAngle going in the given direction by anticlockwise (defaulting to clockwise).\n\t * @param x The X coordinate of the arc's center.\n\t * @param y The Y coordinate of the arc's center.\n\t * @param radius The arc's radius.\n\t * @param startAngle The angle at which the arc starts, measured clockwise from the positive x axis and expressed in radians.\n\t * @param endAngle The angle at which the arc ends, measured clockwise from the positive x axis and expressed in radians.\n\t * @param anticlockwise An optional Boolean which, if true, causes the arc to be drawn counter-clockwise between the two angles. By default it is drawn clockwise.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/arc\n\t */\n\tpublic arc(x: number, y: number, radius: number, startAngle: number, endAngle: number, anticlockwise?: boolean): this {\n\t\tthis.context.arc(x, y, radius, startAngle, endAngle, anticlockwise);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds an arc to the path with the given control points and radius, connected to the previous point by a straight line.\n\t * @param x1 The x axis of the coordinate for the first control point.\n\t * @param y1 The y axis of the coordinate for the first control point.\n\t * @param x2 The x axis of the coordinate for the second control point.\n\t * @param y2 The y axis of the coordinate for the second control point.\n\t * @param radius The arc's radius.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/arcTo\n\t */\n\tpublic arcTo(x1: number, y1: number, x2: number, y2: number, radius: number): this {\n\t\tthis.context.arcTo(x1, y1, x2, y2, radius);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a quadratic Bézier curve to the path. It requires two points. The first point is a control point and the\n\t * second one is the end point. The starting point is the last point in the current path, which can be changed using\n\t * moveTo() before creating the quadratic Bézier curve.\n\t * @param cpx The x axis of the coordinate for the control point.\n\t * @param cpy The y axis of the coordinate for the control point.\n\t * @param x The x axis of the coordinate for the end point.\n\t * @param y The y axis of the coordinate for the end point.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/quadraticCurveTo\n\t */\n\tpublic quadraticCurveTo(cpx: number, cpy: number, x: number, y: number): this {\n\t\tthis.context.quadraticCurveTo(cpx, cpy, x, y);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a cubic Bézier curve to the path. It requires three points. The first two points are control points and the\n\t * third one is the end point. The starting point is the last point in the current path, which can be changed using\n\t * moveTo() before creating the Bézier curve.\n\t * @param cp1x The x axis of the coordinate for the first control point.\n\t * @param cp1y The y axis of the coordinate for first control point.\n\t * @param cp2x The x axis of the coordinate for the second control point.\n\t * @param cp2y The y axis of the coordinate for the second control point.\n\t * @param x The x axis of the coordinate for the end point.\n\t * @param y The y axis of the coordinate for the end point.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/bezierCurveTo\n\t */\n\tpublic bezierCurveTo(cp1x: number, cp1y: number, cp2x: number, cp2y: number, x: number, y: number): this {\n\t\tthis.context.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Connects the last point in the sub-path to the x, y coordinates with a straight line\n\t * @param x The x axis of the coordinate for the end of the line.\n\t * @param y The y axis of the coordinate for the end of the line.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/lineTo\n\t */\n\tpublic lineTo(x: number, y: number): this {\n\t\tthis.context.lineTo(x, y);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Moves the starting point of a new sub-path to the (X, Y) coordinates.\n\t * @param x The x axis of the point.\n\t * @param y The y axis of the point.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/moveTo\n\t */\n\tpublic moveTo(x: number, y: number): this {\n\t\tthis.context.moveTo(x, y);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Set the shadow's blur.\n\t * @param radius The shadow's blur radius to set.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowBlur\n\t */\n\tpublic setShadowBlur(radius: number): this {\n\t\tthis.context.shadowBlur = radius;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Set the shadow's color.\n\t * @param color A canvas' color resolvable to set as shadow's color.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowColor\n\t */\n\tpublic setShadowColor(color: string): this {\n\t\tthis.context.shadowColor = color;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Set the property that specifies the distance that the shadow will be offset in horizontal distance.\n\t * @param value The value in pixels for the distance.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowOffsetX\n\t */\n\tpublic setShadowOffsetX(value: number): this {\n\t\tthis.context.shadowOffsetX = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Set the property that specifies the distance that the shadow will be offset in vertical distance.\n\t * @param value The value in pixels for the distance.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowOffsetY\n\t */\n\tpublic setShadowOffsetY(value: number): this {\n\t\tthis.context.shadowOffsetY = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the miter limit ratio in space units. When getting, it returns the current value (10.0 by default). When\n\t * setting, zero, negative, Infinity and NaN values are ignored; otherwise the current value is set to the new value.\n\t * @param value A number specifying the miter limit ratio in space units. Zero, negative, Infinity and NaN values\n\t * are ignored.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/miterLimit\n\t */\n\tpublic setMiterLimit(value: number): this {\n\t\tthis.context.miterLimit = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Change the pattern quality\n\t * @param pattern The pattern quality.\n\t */\n\tpublic setPatternQuality(pattern: PatternQuality): this {\n\t\tthis.context.patternQuality = pattern;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Set the text drawing mode. Using glyph is much faster than path for drawing, and when using a PDF context will\n\t * embed the text natively, so will be selectable and lower filesize. The downside is that cairo does not have any\n\t * subpixel precision for glyph, so this will be noticeably lower quality for text positioning in cases such as\n\t * rotated text. Also, strokeText in glyph will act the same as fillText, except using the stroke style for the fill.\n\t * @param mode The drawing mode.\n\t */\n\tpublic setTextDrawingMode(mode: TextDrawingMode): this {\n\t\tthis.context.textDrawingMode = mode;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Set anti-aliasing mode.\n\t * @param antialias The antialias mode.\n\t */\n\tpublic setAntialiasing(antialias: AntiAlias): this {\n\t\tthis.context.antialias = antialias;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the type of compositing operation to apply when drawing new shapes, where type is a string identifying which\n\t * of the compositing or blending mode operations to use.\n\t * @param type The global composite operation mode.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation\n\t */\n\tpublic setGlobalCompositeOperation(type: GlobalCompositeOperation): this {\n\t\tthis.context.globalCompositeOperation = type;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Modify the alpha value that is applied to shapes and images before they are drawn into the canvas.\n\t * @param value The alpha value, from 0.0 (fully transparent) to 1.0 (fully opaque)\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalAlpha\n\t */\n\tpublic setGlobalAlpha(value: number): this {\n\t\tthis.context.globalAlpha = value;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the shadow blur and offsets to zero, then sets the shadow color to transparent. If shadows are not longer\n\t * used in a canvas and performance is critical, `.setShadowColor('transparent')` should be used instead, as of the\n\t * [note from Mozilla Developer Network](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/shadowColor).\n\t * @example\n\t * new Canvas(500, 500)\n\t *     // Set a shadow color and blur\n\t *     .setShadowColor('rgba(23, 23, 23, 0.2)')\n\t *     .setShadowBlur(5)\n\t *     // Render the text with a blow effect\n\t *     .printText('Hello', 30, 50)\n\t *     // Reset the shadows\n\t *     .resetShadows()\n\t *     // Render the text without shadows\n\t *     .printText('World!', 30, 100);\n\t */\n\tpublic resetShadows(): this {\n\t\treturn this.setShadowBlur(0).setShadowOffsetX(0).setShadowOffsetY(0).setShadowColor('transparent');\n\t}\n\n\t/**\n\t * Clear a circle.\n\t * @param x The position x in the center of the clip's circle.\n\t * @param y The position y in the center of the clip's circle.\n\t * @param radius The radius for the clip.\n\t * @param start The degree in radians to start drawing the circle.\n\t * @param angleThe degree in radians to finish drawing the circle, defaults to a full circle.\n\t * @param antiClockwise Whether or not the angle should be anti-clockwise.\n\t */\n\tpublic clearCircle(x: number, y: number, radius: number, start = 0, angle = Math.PI * 2, antiClockwise = false): this {\n\t\treturn this.createCircularClip(x, y, radius, start, angle, antiClockwise).clearRectangle(x - radius, y - radius, radius * 2, radius * 2);\n\t}\n\n\t/**\n\t * Clear an area.\n\t * @param x The position x to start drawing the element.\n\t * @param y The position y to start drawing the element.\n\t * @param width The width of the element.\n\t * @param height The height of the element.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/clearRect\n\t */\n\tpublic clearRectangle(dx = 0, dy = 0, width = this.width, height = this.height): this {\n\t\tthis.context.clearRect(dx, dy, width, height);\n\t\treturn this;\n\t}\n\n\t/**\n\t * A list of numbers that specifies distances to alternately draw a line and a gap (in coordinate space units).\n\t * If the number, when setting the elements, was odd, the elements of the array get copied and concatenated. For\n\t * example, setting the line dash to [5, 15, 25] will result in getting back [5, 15, 25, 5, 15, 25].\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getLineDash\n\t * @example\n\t * new Canvas(400, 300)\n\t *     .beginPath()\n\t *     .setLineDash([5, 15])\n\t *     .moveTo(0, 50)\n\t *     .lineTo(400, 50)\n\t *     .stroke()\n\t *     .toBuffer();\n\t */\n\tpublic getLineDash(): number[] {\n\t\treturn this.context.getLineDash();\n\t}\n\n\t/**\n\t * Alias of Canvas#getLineDash();\n\t */\n\tpublic get lineDash(): number[] {\n\t\treturn this.getLineDash();\n\t}\n\n\t/**\n\t * Reports whether or not the specified point is contained in the current path.\n\t * @param x The X coordinate of the point to check.\n\t * @param y The Y coordinate of the point to check.\n\t * @param fillRule The algorithm by which to determine if a point is inside a path or outside a path.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/isPointInPath\n\t */\n\tpublic isPointInPath(x: number, y: number, fillRule?: CanvasFillRule): boolean {\n\t\treturn this.context.isPointInPath(x, y, fillRule);\n\t}\n\n\t/**\n\t * Reports whether or not the specified point is inside the area contained by the stroking of a path.\n\t * @param x The X coordinate of the point to check.\n\t * @param y The Y coordinate of the point to check.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/isPointInStroke\n\t */\n\tpublic isPointInStroke(x: number, y: number): boolean {\n\t\treturn this.context.isPointInStroke(x, y);\n\t}\n\n\tpublic process(fn: (this: Canvas, canvas: Canvas) => unknown): this;\n\tpublic process<P1>(fn: (this: Canvas, canvas: Canvas, arg1: P1) => unknown, arg1: P1): this;\n\tpublic process<P1, P2>(fn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2) => unknown, arg1: P1, arg2: P2): this;\n\tpublic process<P1, P2, P3>(fn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2, arg3: P3) => unknown, arg1: P1, arg2: P2, arg3: P3): this;\n\tpublic process<P1, P2, P3, P4>(\n\t\tfn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2, arg3: P3, arg4: P4) => unknown,\n\t\targ1: P1,\n\t\targ2: P2,\n\t\targ3: P3,\n\t\targ4: P4\n\t): this;\n\n\tpublic process<P1, P2, P3, P4, P5>(\n\t\tfn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2, arg3: P3, arg4: P4, arg5: P5) => unknown,\n\t\targ1: P1,\n\t\targ2: P2,\n\t\targ3: P3,\n\t\targ4: P4,\n\t\targ5: P5\n\t): this;\n\n\tpublic process<P1, P2, P3, P4, P5, P6>(\n\t\tfn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2, arg3: P3, arg4: P4, arg5: P5, arg6: P6) => unknown,\n\t\targ1: P1,\n\t\targ2: P2,\n\t\targ3: P3,\n\t\targ4: P4,\n\t\targ5: P5,\n\t\targ6: P6\n\t): this;\n\n\tpublic process<P1, P2, P3, P4, P5, P6, P7>(\n\t\tfn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2, arg3: P3, arg4: P4, arg5: P5, arg6: P6, arg7: P7) => unknown,\n\t\targ1: P1,\n\t\targ2: P2,\n\t\targ3: P3,\n\t\targ4: P4,\n\t\targ5: P5,\n\t\targ6: P6,\n\t\targ7: P7\n\t): this;\n\n\tpublic process<P1, P2, P3, P4, P5, P6, P7, P8>(\n\t\tfn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2, arg3: P3, arg4: P4, arg5: P5, arg6: P6, arg7: P7, arg8: P8) => unknown,\n\t\targ1: P1,\n\t\targ2: P2,\n\t\targ3: P3,\n\t\targ4: P4,\n\t\targ5: P5,\n\t\targ6: P6,\n\t\targ7: P7,\n\t\targ8: P8\n\t): this;\n\n\tpublic process<P1, P2, P3, P4, P5, P6, P7, P8, P9>(\n\t\tfn: (this: Canvas, canvas: Canvas, arg1: P1, arg2: P2, arg3: P3, arg4: P4, arg5: P5, arg6: P6, arg7: P7, arg8: P8, arg9: P9) => unknown,\n\t\targ1: P1,\n\t\targ2: P2,\n\t\targ3: P3,\n\t\targ4: P4,\n\t\targ5: P5,\n\t\targ6: P6,\n\t\targ7: P7,\n\t\targ8: P8,\n\t\targ9: P9\n\t): this;\n\n\tpublic process<T>(fn: (this: Canvas, canvas: Canvas, ...args: readonly T[]) => unknown, ...args: readonly T[]): this;\n\t/**\n\t * Process data with this as the context\n\t * @param fn A callback function\n\t * @param args Extra arguments to pass to the function\n\t */\n\tpublic process(fn: (this: Canvas, canvas: Canvas, ...args: readonly any[]) => unknown, ...args: readonly any[]): this {\n\t\tfn.call(this, this, ...args);\n\t\treturn this;\n\t}\n\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * For image canvases, encodes the canvas as a PNG. For PDF canvases, encodes the canvas as a PDF. For SVG canvases,\n\t * encodes the canvas as an SVG.\n\t */\n\tpublic toBuffer(): Buffer;\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * Encodes the canvas as a PNG.\n\t * @param mimeType the standard MIME type for the image format to return.\n\t * @param config The render configuration.\n\t */\n\tpublic toBuffer(mimeType: 'image/png', config?: PngConfig): Buffer;\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * Encodes the canvas as a JPG.\n\t * @param mimeType the standard MIME type for the image format to return.\n\t * @param config The render configuration.\n\t */\n\tpublic toBuffer(mimeType: 'image/jpeg', config?: JpegConfig): Buffer;\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * Encodes the canvas as a PDF.\n\t * @param mimeType the standard MIME type for the image format to return.\n\t * @param config The render configuration.\n\t */\n\tpublic toBuffer(mimeType: 'application/pdf', config?: PdfConfig): Buffer;\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * Returns the unencoded pixel data, top-to-bottom. On little-endian (most) systems, the array will be ordered BGRA;\n\t * on big-endian systems, it will be ARGB.\n\t * @param mimeType the standard MIME type for the image format to return.\n\t */\n\tpublic toBuffer(mimeType: 'raw'): Buffer;\n\tpublic toBuffer(...args: readonly any[]): Buffer {\n\t\t// @ts-expect-error: Complains about invalid overload (expects more than 0 overloads).\n\t\treturn this.canvas.toBuffer(...args);\n\t}\n\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * For image canvases, encodes the canvas as a PNG. For PDF canvases, encodes the canvas as a PDF. For SVG canvases,\n\t * encodes the canvas as an SVG.\n\t */\n\tpublic toBufferAsync(): Promise<Buffer>;\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * Encodes the canvas as a PNG.\n\t * @param mimeType the standard MIME type for the image format to return.\n\t * @param config The render configuration.\n\t */\n\tpublic toBufferAsync(mimeType: 'image/png', config?: PngConfig): Promise<Buffer>;\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * Encodes the canvas as a JPG.\n\t * @param mimeType the standard MIME type for the image format to return.\n\t * @param config The render configuration.\n\t */\n\tpublic toBufferAsync(mimeType: 'image/jpeg', config?: JpegConfig): Promise<Buffer>;\n\t/**\n\t * <warn>This is for Node.js usage only, HTMLCanvasElement does not support this</warn>\n\t * Encodes the canvas as a PDF.\n\t * @param mimeType the standard MIME type for the image format to return.\n\t * @param config The render configuration.\n\t */\n\tpublic toBufferAsync(mimeType: 'application/pdf', config?: PdfConfig): Promise<Buffer>;\n\tpublic toBufferAsync(...args: readonly any[]): Promise<Buffer> {\n\t\treturn new Promise<Buffer>((resolve, reject) =>\n\t\t\t// @ts-expect-error: Complains about invalid overload (expects more than 0 overloads).\n\t\t\tthis.canvas.toBuffer((error: Error | null, buffer: Buffer | null): void => {\n\t\t\t\tif (error) reject(error);\n\t\t\t\telse resolve(buffer!);\n\t\t\t}, ...args)\n\t\t);\n\t}\n\n\t/**\n\t * Render the canvas into a PNG Data URL.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL\n\t */\n\tpublic toDataURL(): string;\n\t/**\n\t * Render the canvas into a PNG Data URL.\n\t * @param type the standard MIME type for the image format to return.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL\n\t */\n\tpublic toDataURL(mimeType: 'image/png'): string;\n\t/**\n\t * Render the canvas into a JPEG Data URL.\n\t * @param type the standard MIME type for the image format to return.\n\t * @param quality The quality for the JPEG.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL\n\t */\n\tpublic toDataURL(mimeType: 'image/jpeg', quality?: number): string;\n\tpublic toDataURL(...args: readonly any[]): string {\n\t\treturn this.canvas.toDataURL(...args);\n\t}\n\n\t/**\n\t * Render the canvas into a PNG Data URL.\n\t * @see https://github.com/Automattic/node-canvas#canvastodataurl-sync-and-async\n\t */\n\tpublic toDataURLAsync(): Promise<string>;\n\t/**\n\t * Render the canvas into a PNG Data URL.\n\t * @param type the standard MIME type for the image format to return.\n\t * @see https://github.com/Automattic/node-canvas#canvastodataurl-sync-and-async\n\t */\n\tpublic toDataURLAsync(mimeType: 'image/png'): Promise<string>;\n\t/**\n\t * Render the canvas into a JPEG Data URL.\n\t * @param type the standard MIME type for the image format to return.\n\t * @param quality The quality for the JPEG.\n\t * @see https://github.com/Automattic/node-canvas#canvastodataurl-sync-and-async\n\t */\n\tpublic toDataURLAsync(mimeType: 'image/jpeg'): Promise<string>;\n\t/**\n\t * Render the canvas into a JPEG Data URL.\n\t * @param type the standard MIME type for the image format to return.\n\t * @param config The render configuration.\n\t * @see https://github.com/Automattic/node-canvas#canvastodataurl-sync-and-async\n\t */\n\tpublic toDataURLAsync(mimeType: 'image/jpeg', config: JpegConfig): Promise<string>;\n\t/**\n\t * Render the canvas into a JPEG Data URL.\n\t * @param type the standard MIME type for the image format to return.\n\t * @param quality The quality for the JPEG.\n\t * @see https://github.com/Automattic/node-canvas#canvastodataurl-sync-and-async\n\t */\n\tpublic toDataURLAsync(mimeType: 'image/jpeg', quality: number): Promise<string>;\n\tpublic toDataURLAsync(...args: readonly any[]): Promise<string> {\n\t\treturn new Promise<string>((resolve, reject) =>\n\t\t\t// @ts-expect-error: Complains about invalid overload (expects more than 0 overloads).\n\t\t\tthis.canvas.toDataURL(...args, (error, url) => {\n\t\t\t\tif (error) reject(error);\n\t\t\t\telse resolve(url);\n\t\t\t})\n\t\t);\n\t}\n\n\t/**\n\t * <warn>This is for web usage only, node-canvas does not support this</warn>\n\t * Render the canvas into a Blob object representing the image contained in the canvas\n\t * @param callback A callback function with the resulting `Blob` object as a single argument.\n\t * @param type A string indicating the image format. The default type is `image/png`.\n\t * @param quality A number between 0 and 1 indicating image quality if the requested type is `image/jpeg` or `image/webp`.\n\t * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob\n\t */\n\tpublic toBlob(callback: BlobCallback, type?: string, quality?: any): void {\n\t\treturn this.windowCanvas.toBlob(callback, type, quality);\n\t}\n\n\t/**\n\t * <warn>This is for web usage only, node-canvas does not support this</warn>\n\t * Render the canvas into a Blob object representing the image contained in the canvas\n\t * @param type A string indicating the image format. The default type is `image/png`.\n\t * @param quality A number between 0 and 1 indicating image quality if the requested type is `image/jpeg` or `image/webp`.\n\t */\n\tpublic toBlobAsync(type?: string, quality?: any): Promise<Blob | null> {\n\t\treturn new Promise<Blob | null>((resolve) => this.windowCanvas.toBlob(resolve, type, quality));\n\t}\n\n\t/**\n\t * Wraps a text into a width-limited multi-line text.\n\t * @param text The text to wrap\n\t * @param wrapWidth The wrap width\n\t * @example\n\t * // Calculate the wrapped text and return it, which\n\t * // is useful for storage to avoid re-calculating the\n\t * // wrapped text\n\t * const wrappedText = new Canvas(500, 300)\n\t *     .setTextFont('48px Verdana')\n\t *     .wrapText('Hello World, this is a quite\\nlong text.', 300);\n\t */\n\tpublic wrapText(text: string, wrapWidth: number): string;\n\t/**\n\t * Wraps a text into a width-limited multi-line text.\n\t * @param text The text to wrap\n\t * @param wrapWidth The wrap width\n\t * @param callback The callback receiving the wrapped text.\n\t * @example\n\t * // Wrap the text and add it\n\t * const buffer = new Canvas(500, 300)\n\t *     .setTextFont('48px Verdana')\n\t *     .wrapText('Hello World, this is a quite\\nlong text.', 300, (wrappedText, canvas) => canvas\n\t *         .setTextAlign('center')\n\t *         .addMultilineText(wrappedText, 250, 50))\n\t *     .toBuffer(); // Returns a Buffer\n\t */\n\tpublic wrapText(text: string, wrapWidth: number, callback: WrapTextCallback): this;\n\tpublic wrapText(text: string, wrapWidth: number, callback?: WrapTextCallback): string | this {\n\t\tconst wrappedText = textWrap(this, text, wrapWidth);\n\t\tif (callback) {\n\t\t\tif (typeof callback !== 'function') throw new TypeError('Callback must be a function');\n\t\t\tcallback.call(this, wrappedText, this);\n\t\t\treturn this;\n\t\t}\n\t\treturn wrappedText;\n\t}\n}\n"],"names":["browser","window","internalCanvas","HTMLCanvasElement","require","getFontHeight","font","parseFont","size","kRegexSize","kCache","Map","previous","get","sizeFamily","exec","Number","set","textWrap","canvas","text","wrapWidth","result","buffer","spaceWidth","measureText","width","line","split","spaceLeft","word","wordWidth","wordWidthWithSpace","length","push","join","greyscale","imageData","getImageData","data","i","luminance","putImageData","grayscale","invertGrayscale","invertGreyscale","darkness","myOldFriend","convolute","weights","opaque","side","Math","round","sqrt","halfSide","floor","pixels","src","sw","sh","height","w","h","output","dst","alphaFac","y","x","sy","sx","dstOff","r","g","b","a","cy","cx","scy","scx","srcOff","wt","edgeLaPlaceMatrix","sharpenLaPlaceMatrix","blurLaPlaceMatrix","[object Object]","type","this","createCanvas","context","getContext","windowCanvas","value","textFontHeight","changeCanvasWidth","changeCanvasHeight","save","restore","angle","rotate","scale","translate","fillRule","clip","args","setTransform","callback","TypeError","call","fill","rest","fillText","maxWidth","style","currentSize","parseInt","newLength","setTextFont","printText","lines","linePositionY","wrappedText","printMultilineText","stroke","strokeRect","strokeText","color","strokeStyle","lineWidth","setLineWidth","lineDashOffset","lineJoin","lineCap","segments","setLineDash","image","drawImage","imageOrBuffer","radius","createCircularClip","PI","printImage","createBeveledClip","createCircularPath","fillRect","createBeveledPath","dx","dy","start","antiClockwise","beginPath","arc","rect","createRectanglePath","radiusObject","undefined","tl","min","tr","br","bl","moveTo","lineTo","quadraticCurveTo","closePath","fillStyle","align","textAlign","baseline","textBaseline","repetition","pattern","createPattern","setColor","x0","y0","x1","y1","steps","gradient","createLinearGradient","step","addColorStop","position","setStroke","r0","r1","createRadialGradient","radiusX","radiusY","rotation","startAngle","endAngle","anticlockwise","ellipse","createEllipsePath","x2","y2","arcTo","cpx","cpy","cp1x","cp1y","cp2x","cp2y","bezierCurveTo","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","miterLimit","patternQuality","mode","textDrawingMode","antialias","globalCompositeOperation","globalAlpha","setShadowBlur","setShadowOffsetX","setShadowOffsetY","setShadowColor","clearRectangle","clearRect","getLineDash","lineDash","isPointInPath","isPointInStroke","fn","toBuffer","Promise","resolve","reject","error","toDataURL","url","quality","toBlob","passes","brightness","hex","hue","saturation","lightness","alpha","setGlobalCompositeOperation","printRectangle","threshold","options","Object","assign","document","createElement","cleanup","onload","onerror","Error","loadImage","red","green","blue"],"mappings":"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"}